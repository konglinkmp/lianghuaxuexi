# A股量化交易决策辅助工具

## 📌 项目背景
本项目是一个基于 Python 的量化辅助系统，旨在收盘后分析 A 股数据，根据预设策略输出具体的交易计划（包括股票代码、买入建议、止损价、止盈价）。用户可根据此计划手动在券商 App 上挂条件单，以规避情绪化交易。

## 🚀 核心功能
- **数据抓取**：使用开源库 `AKShare` 获取 A 股历史行情及指数数据。
- **选股过滤**：自动获取全 A 股列表，剔除 ST 股、退市股及上市不满 1 年的新股。
- **自定义池**：支持通过 `myshare.txt` 导入自定义关注的股票池。
- **量化策略**：内置经典“动能+趋势”策略，并增加“防追高”过滤。
- **回测引擎**：新增回测模块，支持计算胜率、盈亏比、最大回撤等核心指标。
- **计划生成**：自动计算建议买入价、止损价、止盈价及建议仓位。
- **风险控制**：大盘环境监控，当沪深 300 指数跌破 60 日均线时提示风险并停止买入。
- **稳定性增强**：数据获取增加自动重试机制与详细日志记录。

## 📂 项目结构
```text
量化/
├── main.py              # 主程序入口，负责流程调度
├── backtester.py        # 回测引擎，验证策略历史表现
├── config.py            # 配置文件，包含策略参数和资金管理
├── data_fetcher.py      # 数据获取模块，封装 AKShare 接口
├── stock_pool.py        # 选股池管理，负责股票过滤逻辑
├── strategy.py          # 策略模块，实现买入/止损/止盈逻辑
├── plan_generator.py    # 计划生成模块，输出操作清单
├── myshare.txt          # 自定义股票池配置文件
├── requirements.txt     # 项目依赖列表
└── README.md            # 项目说明文档
```

## 🛠 安装与使用

### 1. 安装依赖
推荐使用 Python 3.9+ 环境：
```bash
pip3 install -r requirements.txt
```

### 2. 运行程序
**分析全 A 股（默认模式）：**
```bash
python3 main.py
```

**运行策略回测：**
```bash
python3 backtester.py
```

**使用自定义股票池：**
1. 在 `myshare.txt` 中输入股票代码（每行一个）。
2. 运行命令：
```bash
python3 main.py --custom
```

**测试模式（限制分析数量）：**
```bash
python3 main.py --limit 50
```

## 📈 策略逻辑说明

### 买入条件
1. **趋势确认**：收盘价站上 20 日均线（MA20）。
2. **动能爆发**：当日成交量较前一日放大 1.2 倍以上。
3. **防追高过滤**：收盘价偏离 MA20 不超过 3%。

### 止损逻辑
设定触发价为以下二者中的**较高值**：
- 买入价下跌 5%。
- 跌破 20 日均线（MA20）。

### 止盈逻辑
- **固定止盈**：目标收益率为 15%。
- **移动止盈**：当股价从持仓期间最高点回落 8% 时触发止盈（保护利润）。

### 仓位管理
- 默认单只股票占用总资金的 10%。

## 📊 输出示例
程序运行后将在终端输出“明日操作清单”，并同步保存至 `trading_plan.csv`。

```text
【1】蓝色光标 (300058)
    收盘价: ¥11.52
    建议买入价: ¥11.52
    止损价: ¥10.94 (跌破即卖出)
    止盈价: ¥13.25 (达到即卖出)
    建议仓位: 800股 (约¥9216，占10%)
```

## ⚠️ 免责声明
本工具仅供量化交易学习与辅助决策参考，不构成任何投资建议。股市有风险，入市需谨慎。
